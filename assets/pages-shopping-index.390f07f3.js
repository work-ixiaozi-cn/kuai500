import{d as a,r as e,o as t,c as l,w as s,a as d,N as u,R as o,Q as n,i as r,e as p,f,O as i,P as c,b as x,t as _,a5 as g,a6 as v,g as b,h as m,U as y,aa as h,s as k,v as w,x as C}from"./index.cf819d24.js";import{_ as j}from"./page.vue_vue_type_script_setup_true_lang.e73b259d.js";import{_ as G}from"./nav_bar.vue_vue_type_script_setup_true_lang.c285c6a0.js";import{_ as L}from"./pay.vue_vue_type_script_setup_true_lang.2aa5733c.js";import{_ as S}from"./uni-card.36ed251a.js";import{a as $}from"./index.821f9091.js";import{g as O}from"./router.6937c411.js";import{d as D}from"./tools.1a322396.js";import"./uni-nav-bar.6de95021.js";import"./uni-icons.ba5e75da.js";const F=a({__name:"index_main",emits:["change"],setup(a,{emit:h}){const k=e({currentList:0,currentGoods:0,lists:[]});$.goods({}).then((a=>{0===a.data.code&&(k.value.lists=a.data.data,w(0))}));const w=a=>{k.value.currentList=a,k.value.currentGoods=0,h("change",k.value.lists[k.value.currentList].goods[k.value.currentGoods])};return(a,e)=>{const C=r,j=b,G=m,L=y,$=p(f("uni-card"),S);return t(),l(C,{class:""},{default:s((()=>[d($,{class:"!border-0",title:"套餐购买",border:"",margin:"0",spacing:"0","is-shadow":!1},{default:s((()=>[d(C,{class:"flex"},{default:s((()=>[d(C,{class:"rounded-10px mr-13px"},{default:s((()=>[(t(!0),u(n,null,o(k.value.lists,((a,e)=>(t(),u(n,{key:e},[0!==e?(t(),l(C,{key:0,class:"h-1px bg-gray-300 mx-10px"})):i("",!0),d(C,{class:"relative"},{default:s((()=>[d(j,{class:c(["rounded-10px p-10px",e===k.value.currentList?"bg-b7f5e6":""]),"hover-class":"bg-b7f5e6",onClick:a=>w(e)},{default:s((()=>[d(C,{class:"text-16px text-center p-5px break-normal whitespace-nowrap"},{default:s((()=>[x(_(a.category_name),1)])),_:2},1024),d(C,{class:"text-12px text-center p-5px"},{default:s((()=>[x("流量5M")])),_:1})])),_:2},1032,["class","onClick"]),e===k.value.currentList?(t(),l(C,{key:0,class:"absolute right-0 h-full top-0 w-10px -right-13px flex"},{default:s((()=>[d(C,{class:"flex-auto"}),d(C,{class:"self-center bg-white w-0 h-0 inline border-y-8px border-r-8px border-r-b7f5e6 border-t-transparent border-b-transparent"})])),_:1})):i("",!0)])),_:2},1024)],64)))),128))])),_:1}),d(C,{class:"flex-auto bg-b7f5e6 rounded-10px p-5px -ml-1px"},{default:s((()=>[(t(!0),u(n,null,o(k.value.lists,((a,e)=>g((t(),l(C,{key:e,class:"w-full h-full p-8px"},{default:s((()=>[d(C,{class:"text-12px"},{default:s((()=>[x("购买本套餐可同时2台设备登录")])),_:1}),(t(!0),u(n,null,o(null==a?void 0:a.goods,((a,e)=>(t(),l(C,{key:e,class:"my-12px"},{default:s((()=>[d(j,{class:"flex p-0 m-0 bg-transparent overflow-visible","hover-class":"bg-transparent",onClick:a=>(a=>{k.value.currentGoods=a,h("change",k.value.lists[k.value.currentList].goods[k.value.currentGoods])})(e)},{default:s((()=>[d(C,{class:"p-12px min-w-80px text-center bg-17a876 rounded-l-10px text-fff text-14px font-semibold self-center h-full"},{default:s((()=>[x(_(a.goods_name),1)])),_:2},1024),d(C,{class:c(["flex-auto flex relative bg-white border-l-0 rounded-r-10px border-17a876 max-h-50px",e==k.value.currentGoods?"border-2px":"border-1px"])},{default:s((()=>[d(C,{class:"flex-auto self-center text-left"},{default:s((()=>[d(G,{class:"text-16px"},{default:s((()=>[x("￥"+_(a.price)+"元",1)])),_:2},1024),d(G,{class:"text-12px text-gray-400 line-through ml-5px"},{default:s((()=>[x("￥29元")])),_:1})])),_:2},1024),d(C,{class:"self-center flex pr-10px"},{default:s((()=>[d(L,{class:"w-18px max-h-20px",src:`/static/icons/${e==k.value.currentGoods?"checked":"unchecked"}.png`,fit:"cover",mode:"widthFix"},null,8,["src"])])),_:2},1024),d(C,{class:"absolute -top-10px -right-3px rounded-full bg-yellow-500 text-8px py-3px px-5px text-fff"},{default:s((()=>[x(" 享折扣 ")])),_:1})])),_:2},1032,["class"])])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:2},1024)),[[v,e===k.value.currentList]]))),128))])),_:1})])),_:1})])),_:1})])),_:1})}}}),I=a({__name:"index_tuan_card",props:{data:null},setup(a){var u,o;const n=a,c=e({days:0,hours:0,minutes:0,seconds:0});return setInterval((()=>{n.data.found&&0===n.data.found.status&&(c.value=D(Date.now(),1e3*n.data.found.found_end_time)),n.data.follow&&0===n.data.follow.status&&(console.log(n.data.follow&&0===n.data.follow.status),c.value=D(Date.now(),1e3*n.data.follow.found.found_end_time))}),1e3),console.log([1,2,3].indexOf(null==(u=n.data.found)?void 0:u.status)),null==(o=n.data.found)||o.status,(a,e)=>{var u,o;const g=m,v=r,y=b,k=p(f("uni-card"),S);return-1===[1,2,3].indexOf(null==(u=n.data.found)?void 0:u.status)||-1===[1,2,3].indexOf(null==(o=n.data.follow)?void 0:o.status)?(t(),l(v,{key:0},{default:s((()=>[d(k,{class:"!border-0 !border-1px !rounded-8px",border:!1,padding:"0",margin:"0",spacing:"0",isShadow:!1,isFull:""},{title:s((()=>[d(v,{class:"flex"},{default:s((()=>[d(v,{class:"bg-17a876 rounded-br-10px px-15px text-fff"},{default:s((()=>[n.data.found||n.data.follow?(t(),l(g,{key:1},{default:s((()=>[c.value?(t(),l(g,{key:0},{default:s((()=>[d(g,null,{default:s((()=>[x(_(24*c.value.days+c.value.hours)+":",1)])),_:1}),d(g,null,{default:s((()=>[x(_(c.value.minutes.toString().padStart(2,"0"))+":",1)])),_:1}),d(g,null,{default:s((()=>[x(_(c.value.seconds.toString().padStart(2,"0")),1)])),_:1})])),_:1})):(t(),l(g,{key:1},{default:s((()=>[x("已过期")])),_:1}))])),_:1})):(t(),l(g,{key:0},{default:s((()=>[x("未开团")])),_:1}))])),_:1})])),_:1})])),default:s((()=>[d(v,{class:"p-5px"},{default:s((()=>[d(v,{class:"flex py-5px"},{default:s((()=>[d(v,{class:"flex-auto"},{default:s((()=>[d(v,{class:"text-14px mb-10px"},{default:s((()=>[x(_(n.data.name),1)])),_:1}),d(v,null,{default:s((()=>[d(g,{class:"text-12px"},{default:s((()=>[x("拼团价")])),_:1}),d(g,{class:"text-18px font-semibold"},{default:s((()=>{var a;return[x("￥"+_(null==(a=n.data.goods)?void 0:a.pintuan_price),1)]})),_:1})])),_:1})])),_:1}),d(v,{class:"self-center"},{default:s((()=>{var a,d;return[0===(null==(a=n.data.found)?void 0:a.status)?(t(),l(y,{key:0,class:"!border-0 rounded-full !bg-ffd400 text-12px py-5px px-8px",onClick:e[0]||(e[0]=a=>h(O)(`/pages/shopping/tuan_open?found_id=${n.data.found.found_id}`))},{default:s((()=>[x("立即支付 ")])),_:1})):i("",!0),0===(null==(d=n.data.follow)?void 0:d.status)?(t(),l(y,{key:1,class:"!border-0 rounded-full !bg-ffd400 text-12px py-5px px-8px",onClick:e[1]||(e[1]=a=>h(O)(` ? /pages/shopping/tuan_join?found_id=${n.data.follow.found_id}`))},{default:s((()=>[x("立即支付 ")])),_:1})):i("",!0),n.data.found||n.data.follow?i("",!0):(t(),l(y,{key:2,class:"!border-0 rounded-full !bg-ffd400 text-12px py-5px px-8px",onClick:e[2]||(e[2]=a=>h(O)(`/pages/shopping/tuan_open?pintuan_id=${n.data.id}`))},{default:s((()=>[x("发起拼团 ")])),_:1})),!n.data.found&&n.data.follow?(t(),l(y,{key:3,class:"!border-0 rounded-full !bg-ffd400 text-12px py-5px px-8px",onClick:e[3]||(e[3]=a=>h(O)(`/pages/shopping/tuan_pay?pintuan_id=${n.data.id}`))},{default:s((()=>[x("参与拼团 ")])),_:1})):i("",!0)]})),_:1})])),_:1}),d(v,{class:"text-12px"},{default:s((()=>[x(" 已参与0人，还差0人拼团成功 ")])),_:1})])),_:1})])),_:1})])),_:1})):i("",!0)}}}),M=a({__name:"index_tuan",setup(a){const c=e(!1),g=e({list:[],count:0});return $.pintuan({}).then((a=>{0==a.data.code?(c.value=!0,g.value.count=a.data.data.count,g.value.list.push(...a.data.data.list),console.log({aa:g.value.list[0].id})):console.log(a.data.data)})),(a,e)=>{const v=r,m=b,y=p(f("uni-card"),S);return c.value?(t(),l(v,{key:0},{default:s((()=>[d(y,{class:"!border-0",border:!1,"is-full":"",padding:"0",margin:"0",spacing:"0",title:"拼团活动","is-shadow":!1},{title:s((()=>[d(v,{class:"flex justify-between p-5px"},{default:s((()=>[d(v,null,{default:s((()=>[x("拼团活动")])),_:1}),d(m,{class:"inline m-0 bg-transparent p-0 text-14px",onClick:e[0]||(e[0]=a=>h(O)("/pages/shopping/tuan"))},{default:s((()=>[x("查看更多")])),_:1})])),_:1})])),default:s((()=>[d(v,{class:"grid grid-cols-2"},{default:s((()=>[(t(!0),u(n,null,o(g.value.list,((a,e)=>(t(),l(I,{key:e,class:"m-10px",data:a,kind:"open"},null,8,["data"])))),128))])),_:1})])),_:1}),x(" "+_(a.props),1)])),_:1})):i("",!0)}}}),N=a({__name:"index",setup(a){const u=e(),o=a=>{console.log(a),u.value=a},n=a=>{var e;k({title:"正在创建订单..."}),$.orderCreate({goods_id:null==(e=u.value)?void 0:e.goods_id,goods_num:1,payment_type:a+1}).then((a=>{if(w(),0!==a.data.code)return C({title:a.data.data});C({title:"创建订单成功"})}))};return(a,e)=>{const p=r;return t(),l(j,{class:"h-tab-page"},{navbar:s((()=>[d(G,{title:"购买",backgroundColor:"#03a976",left:!1,fixed:""})])),bottom:s((()=>{var a;return[d(L,{class:"pb-15px",money:null==(a=u.value)?void 0:a.promotion_price,onClick:n},null,8,["money"])]})),default:s((()=>[d(p,null,{default:s((()=>[d(M,{class:"my-10px"}),d(F,{class:"my-10px",onChange:o})])),_:1})])),_:1})}}});export{N as default};
