import{d as e,o as t,c as a,w as l,a as s,b as u,i as n,j as o,U as d,e as r,f as c,r as i,g as p,_ as f,t as x,P as _,V as m,O as g,h as v,ah as y,aa as b,N as h,R as k,Q as w,ai as j}from"./index.cf819d24.js";import{_ as S}from"./page.vue_vue_type_script_setup_true_lang.e73b259d.js";import{_ as C}from"./nav_bar.vue_vue_type_script_setup_true_lang.c285c6a0.js";import{_ as V}from"./uni-card.36ed251a.js";import{_ as B,a as I,b as T}from"./gift.30625a0a.js";import{_ as F}from"./tuan_card.vue_vue_type_script_setup_true_lang.21fa02a8.js";import{_ as U,a as $,b as z}from"./uni-forms.c1e1db30.js";import{g as E}from"./router.6937c411.js";import{_ as M}from"./uni-segmented-control.ae1f7369.js";import{d as q}from"./tools.1a322396.js";import{a as D}from"./index.821f9091.js";import"./uni-nav-bar.6de95021.js";import"./uni-icons.ba5e75da.js";import"./logo.79283f64.js";const L=e({__name:"tuan_desc",setup:e=>(e,i)=>{const p=n,f=o,x=d,_=r(c("uni-card"),V);return t(),a(p,null,{default:l((()=>[s(p,{class:"flex justify-between py-10px text-fff"},{default:l((()=>[s(p,null,{default:l((()=>[u("拼团玩法")])),_:1}),s(f,{class:"text-14px",url:"/pages/help/page?id=1"},{default:l((()=>[u("拼团说明")])),_:1})])),_:1}),s(_,{class:"!rounded-10px",padding:"0",margin:"0",spacing:"0","is-shadow":!1},{default:l((()=>[s(p,{class:"border-1px rounded-10px flex text-center py-15px"},{default:l((()=>[s(p,{class:"flex-1"},{default:l((()=>[s(p,{class:"flex"},{default:l((()=>[s(p,{class:"flex-center flex-auto"}),s(p,{class:"bg-07a978 w-30px h-30px p-8px rounded-full"},{default:l((()=>[s(x,{class:"w-18px h-18px mx-auto",src:B,fit:"cover",mode:"widthFix"})])),_:1}),s(p,{class:"flex-auto self-center h-1px bg-red-300"})])),_:1}),s(p,{class:"pt-10px"},{default:l((()=>[s(p,{class:"text-14px py-2px"},{default:l((()=>[u("邀请好友")])),_:1}),s(p,{class:"text-12px py-2px"},{default:l((()=>[u("向好友发送邀请")])),_:1})])),_:1})])),_:1}),s(p,{class:"flex-1"},{default:l((()=>[s(p,{class:"flex"},{default:l((()=>[s(p,{class:"flex-auto self-center h-1px bg-red-300"}),s(p,{class:"bg-07a978 w-30px h-30px p-6px rounded-full"},{default:l((()=>[s(x,{class:"w-12px h-12px mx-auto",src:I,fit:"cover",mode:"widthFix"})])),_:1}),s(p,{class:"flex-auto self-center h-1px bg-red-300"})])),_:1}),s(p,{class:"pt-10px"},{default:l((()=>[s(p,{class:"text-14px py-2px"},{default:l((()=>[u("邀请好友")])),_:1}),s(p,{class:"text-12px py-2px"},{default:l((()=>[u("向好友发送邀请")])),_:1})])),_:1})])),_:1}),s(p,{class:"flex-1"},{default:l((()=>[s(p,{class:"flex"},{default:l((()=>[s(p,{class:"flex-auto self-center h-1px bg-red-300"}),s(p,{class:"bg-07a978 w-30px h-30px p-6px rounded-full"},{default:l((()=>[s(x,{class:"w-16px h-16px mx-auto",src:T,fit:"cover",mode:"widthFix"})])),_:1}),s(p,{class:"flex-center flex-auto"})])),_:1}),s(p,{class:"pt-10px"},{default:l((()=>[s(p,{class:"text-14px py-2px"},{default:l((()=>[u("邀请好友")])),_:1}),s(p,{class:"text-12px py-2px"},{default:l((()=>[u("向好友发送邀请")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}),N=e({__name:"tuan_invite",setup(e){const o=i({data:{code:""},rules:{code:{rules:[{required:!0,errorMessage:"请输入邀请码"},{minLength:4,errorMessage:"邀请码长度不够"}]}}}),d=i(null),f=()=>d.value.validate().then((e=>E(`/pages/shopping/tuan_join?code=${e.code}`)));return(e,i)=>{const x=r(c("uni-easyinput"),U),_=n,m=r(c("uni-forms-item"),$),g=p,v=r(c("uni-forms"),z),y=r(c("uni-card"),V);return t(),a(_,{class:"opacity-80"},{default:l((()=>[s(y,{class:"!border-0 !bg-opacity-80 !bg-white-100 !rounded-10px",border:!1,margin:"0",spacing:"0","is-shadow":!1,title:"我要拼团"},{default:l((()=>[s(v,{class:"px-5 pt-5",ref_key:"forms",ref:d,modelValue:o.value.data,rules:o.value.rules},{default:l((()=>[s(_,{class:"px-5"},{default:l((()=>[s(m,{class:"text-center placeholder-text-center",name:"code"},{default:l((()=>[s(_,{class:"border-b-1px"},{default:l((()=>[s(x,{inputBorder:!1,modelValue:o.value.data.code,"onUpdate:modelValue":i[0]||(i[0]=e=>o.value.data.code=e),styles:"{'background-color': 'tranparent'}",placeholder:"请输入您的参团邀请码"},null,8,["modelValue"])])),_:1})])),_:1}),s(_,{class:"mt-15px"},{default:l((()=>[s(g,{class:"rounded-full py-5px bg-07a978 w-120px text-fff text-14px",onClick:f},{default:l((()=>[u("参团")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue","rules"])])),_:1})])),_:1})}}});const O=f({name:"UniTag",emits:["click"],props:{type:{type:String,default:"default"},size:{type:String,default:"normal"},text:{type:String,default:""},disabled:{type:[Boolean,String],default:!1},inverted:{type:[Boolean,String],default:!1},circle:{type:[Boolean,String],default:!1},mark:{type:[Boolean,String],default:!1},customStyle:{type:String,default:""}},computed:{classes(){const{type:e,disabled:t,inverted:a,circle:l,mark:s,size:u,isTrue:n}=this;return["uni-tag--"+e,"uni-tag--"+u,n(t)?"uni-tag--disabled":"",n(a)?"uni-tag--"+e+"--inverted":"",n(l)?"uni-tag--circle":"",n(s)?"uni-tag--mark":"",n(a)?"uni-tag--inverted uni-tag-text--"+e:"","small"===u?"uni-tag-text--small":""].join(" ")}},methods:{isTrue:e=>!0===e||"true"===e,onClick(){this.isTrue(this.disabled)||this.$emit("click")}}},[["render",function(e,s,n,o,d,r){const c=v;return n.text?(t(),a(c,{key:0,class:_(["uni-tag",r.classes]),style:m(n.customStyle),onClick:r.onClick},{default:l((()=>[u(x(n.text),1)])),_:1},8,["class","style","onClick"])):g("",!0)}],["__scopeId","data-v-103873e5"]]),P=e({__name:"tuan_main_card",emits:["click"],setup(e,{emit:o}){const d=y();console.log({tuan_main_card_attrs:d});const f=()=>{};if("join"==d.kind){const e=i({days:0,hours:0,minutes:0,seconds:0});setInterval((()=>e.value=q(Date.now(),1e3*d.join.found_end_time)),1e3)}return(e,o)=>{const i=v,_=r(c("uni-tag"),O),m=n,y=p,h=r(c("uni-card"),V);return t(),a(m,{class:"opacity-99"},{default:l((()=>[s(h,{class:"!border-0 !bg-opacity-80 !bg-white-100 !rounded-10px",border:!1,margin:"0px",spacing:"15px","is-shadow":!1},{title:l((()=>[s(m,{class:"flex justify-between"},{default:l((()=>[s(m,null,{default:l((()=>[s(i,null,{default:l((()=>[u(x(b(d).name),1)])),_:1}),s(_,{class:"!rounded-full !border-none !bg-ffd400 !py-2px ml-10px !text-black",text:`立省${b(d).goods.pintuan_price-b(d).goods.goods_price}元`},null,8,["text"])])),_:1}),"join"===b(d).kind?(t(),a(m,{key:0},{default:l((()=>[s(i,{class:"mx-3px bg-red-300 font-bold p-3px"},{default:l((()=>[u(x(24*e.countdown.days+e.countdown.hours),1)])),_:1}),s(i,null,{default:l((()=>[u(":")])),_:1}),s(i,{class:"mx-3px bg-red-300 font-bold p-3px"},{default:l((()=>[u(x(e.countdown.minutes.toString().padStart(2,"0")),1)])),_:1}),s(i,null,{default:l((()=>[u(":")])),_:1}),s(i,{class:"mx-3px bg-red-300 font-bold p-3px"},{default:l((()=>[u(x(e.countdown.seconds.toString().padStart(2,"0")),1)])),_:1})])),_:1})):g("",!0)])),_:1})])),default:l((()=>[s(m,{class:"flex"},{default:l((()=>[s(m,{class:"flex-auto"},{default:l((()=>[s(m,{class:"mb-10px"},{default:l((()=>[s(i,{class:"text-16px"},{default:l((()=>[u("拼团价")])),_:1}),s(i,{class:"text-24px font-semibold"},{default:l((()=>[u("￥"+x(b(d).goods.goods_price),1)])),_:1}),s(i,{class:"text-12px line-through ml-10px"},{default:l((()=>[u("原价："+x(b(d).goods.pintuan_price),1)])),_:1})])),_:1}),s(m,{class:"text-12px"},{default:l((()=>[s(i,null,{default:l((()=>[u("已参与")])),_:1}),s(i,null,{default:l((()=>[u(x("join"===b(d).kind?b(d).join.join:0),1)])),_:1}),s(i,null,{default:l((()=>[u("人，还差")])),_:1}),s(i,null,{default:l((()=>[u(x(b(d).join_num),1)])),_:1}),s(i,null,{default:l((()=>[u("人拼团成功")])),_:1})])),_:1})])),_:1}),s(m,{class:"self-center"},{default:l((()=>[s(y,{class:"rounded-full bg-ffd400 py-5px w-120px",onClick:f},{default:l((()=>["open"===b(d).kind?(t(),a(i,{key:0},{default:l((()=>[u("立即开团")])),_:1})):g("",!0),"join"===b(d).kind?(t(),a(i,{key:1},{default:l((()=>[u("立即参团")])),_:1})):g("",!0)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}}),Q=e({__name:"tuan_empty",emits:["click"],setup(e,{emit:o}){const r=y();return(e,o)=>{const c=d,i=n;return t(),a(i,{class:"text-center"},{default:l((()=>[s(c,{class:"!w-full",src:"./static/icons/empty.png",fit:"cover",mode:"widthFix"}),s(i,null,{default:l((()=>[u(x(b(r).title),1)])),_:1})])),_:1})}}}),R=e({__name:"tuan_main",props:{data:null},setup(e){const u=e,o=i({current:0,change:e=>o.value.current=e.currentIndex}),d=i([]);return setTimeout((()=>{var e;null==(e=u.data)||e.forEach((e=>{var t;return!e.found&&!e.follow&&(null==(t=d.value)?void 0:t.push(e))&&console.log(d.value)}))}),1e3),(e,u)=>{const i=r(c("uni-segmented-control"),M),p=n;return t(),a(p,{class:"opacity-80"},{default:l((()=>{var e;return[s(i,{current:o.value.current,values:["我要开团","我要参团"],"active-color":"#07a978",onClickItem:o.value.change},null,8,["current","onClickItem"]),(null==(e=d.value)?void 0:e.every((e=>o.value.current?!!e.join:!!e.follow&&!!e.found)))?g("",!0):(t(),a(Q,{key:0,class:"w-120px mx-auto",title:o.value.current?"暂无人开团":"暂时无团"},null,8,["title"])),(t(!0),h(w,null,k(d.value,((e,l)=>(t(),h(w,{key:l},[(o.value.current?e.join:e.follow&&e.found)?(t(),a(P,j({key:0,kind:o.value.current?"join":"open",class:"my-10px"},e),null,16,["kind"])):g("",!0)],64)))),128))]})),_:1})}}}),A=e({__name:"tuan",setup(e){const u=i({permission:!0,list:[],count:0}),o=i(0);D.pintuan({}).then((e=>{0==e.data.code&&(u.value.permission=e.data.data.permission,u.value.list.push(...e.data.data.list),console.log(u.value.list),d())}));const d=()=>{u.value.list.forEach((e=>{var t,a;(null==(t=e.found)?void 0:t.status)>0&&o.value++,(null==(a=e.follow)?void 0:a.status)>0&&o.value++}))};return(e,o)=>{const d=n;return t(),a(S,null,{navbar:l((()=>[s(d,{class:"bg-03a976 rounded-b-20px -mb-100px pb-70px"},{default:l((()=>[s(C,{title:"拼团活动",backgroundColor:"#03a976",fixed:""})])),_:1})])),default:l((()=>[s(d,{class:"m-10px"},{default:l((()=>[s(L,{class:"my-10px"}),s(N,{if:"pintuan.count > current_times",class:"my-10px"}),(t(!0),h(w,null,k(u.value.list,((e,l)=>(t(),a(F,j({key:l},e,{status:"open",class:"my-10px"}),null,16)))),128)),s(R,{data:u.value.list,class:"my-10px"},null,8,["data"])])),_:1})])),_:1})}}});export{A as default};
